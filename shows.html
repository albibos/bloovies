<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>consumet api</title>
  <link rel="stylesheet" href="https://cdn.plyr.io/1.8.2/plyr.css">
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<style>
  .player {
    width: 100vw;
    height: 100vh;
    border: none;
  }
</style>

<body>
  <video id="player" autoplay controls crossorigin></video>
  <script src="https://cdn.plyr.io/1.8.2/plyr.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const urlParams = new URLSearchParams(window.location.search);
      const video = document.getElementById("player");

      const episodeId = urlParams.get("episode");
      const mediaId = urlParams.get("show");

      if (Hls.isSupported() && episodeId && mediaId) {
        var hls = new Hls();
        fetch(`https://api.consumet.org/movies/flixhq/watch?episodeId=${episodeId}&mediaId=${mediaId}`)
          .then(response => response.json())
          .then(data => {
            hls.loadSource(data.sources[0].url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function () {
              video.play();
            });
          });
      }

      plyr.setup(video);


    });
  </script>
</body>

</html>
